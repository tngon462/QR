<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>T-NGON</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* S·ª≠ d·ª•ng font Inter cho to√†n b·ªô trang */
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f3f4f6;
    }
    .main-container {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100vh;
      width: 100vw;
      padding: 1rem;
      box-sizing: border-box;
    }
    .screen {
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        width: 100%;
        height: 100%;
    }
    #table-selection-screen {
        display: flex;
    }
    .button-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 1.5rem;
      max-width: 600px;
      margin: 2rem auto 0 auto; /* CƒÉn gi·ªØa c√°c n√∫t */
    }
    .table-button {
      font-size: 2rem;
      font-weight: bold;
      padding: 2rem 1rem;
      background-color: #007aff; /* ƒê·ªïi m√†u n·ªÅn n√∫t */
      color: white; /* ƒê·ªïi m√†u ch·ªØ */
      border: 2px solid #007aff;
      border-radius: 0.75rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .table-button:hover {
      background-color: #005fbc; /* ƒê·ªïi m√†u n·ªÅn khi hover */
      border-color: #005fbc;
      transform: translateY(-2px);
    }
    .start-button {
      font-size: 2.5rem;
      padding: 1.25rem 2.5rem;
      background-color: #007aff;
      color: white;
      border: none;
      border-radius: 0.75rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .start-button:hover {
      background-color: #005fbc;
      transform: translateY(-2px);
    }
    .start-button:active {
      transform: translateY(0);
      box-shadow: none;
    }
    .iframe-container {
      width: 100%;
      height: 100%;
      border: none;
      overflow: hidden;
    }
    .loading-indicator {
        font-size: 1.5rem;
        color: #6b7280;
        margin-top: 1rem;
    }
    .error-message {
        color: #ef4444;
        font-size: 1.2rem;
        margin-top: 1rem;
    }
    @media (max-width: 640px) {
      .button-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 1rem;
      }
      .table-button {
        font-size: 1.5rem;
        padding: 1.5rem 0.5rem;
      }
      .start-button {
        font-size: 2rem;
        padding: 1rem 2rem;
      }
    }
    .return-button {
      position: absolute;
      bottom: 10px; /* S√°t g√≥c d∆∞·ªõi */
      left: 10px; /* S√°t g√≥c tr√°i */
      width: 50px; /* K√≠ch th∆∞·ªõc nh·ªè */
      height: 50px;
      padding: 0; /* B·ªè padding */
      background-color: rgba(255, 255, 255, 0.1); /* N·ªÅn trong su·ªët */
      color: transparent; /* Ch·ªØ trong su·ªët */
      border: 1px solid transparent; /* Vi·ªÅn trong su·ªët */
      border-radius: 0.5rem;
      cursor: pointer;
      z-index: 100;
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
    }
    .return-button:hover {
      background-color: rgba(255, 255, 255, 0.3); /* N·ªÅn s·∫Ω r√µ h∆°n khi di chu·ªôt */
    }
  </style>
</head>
<body class="bg-gray-100">
  <div class="main-container" id="main-container">
    <!-- M√†n h√¨nh ch·ªçn b√†n -->
    <div class="screen" id="table-selection-screen">
      <h2 class="text-5xl font-bold text-gray-800">T-NGON</h2>
      <p class="text-lg text-gray-600 mt-2">Vui l√≤ng ch·ªçn b√†n c·ªßa b·∫°n</p>
      <div class="button-grid">
        <script>
            // T·∫°o 15 n√∫t b√†n t·ª± ƒë·ªông
            for (let i = 1; i <= 15; i++) {
                document.write(`<button class="table-button" onclick="selectTable(${i})">B√†n ${i}</button>`);
            }
        </script>
      </div>
    </div>
    
    <!-- M√†n h√¨nh b·∫Øt ƒë·∫ßu cho t·ª´ng b√†n -->
    <div class="screen" id="start-screen">
      <div class="space-y-4 text-gray-800 text-center">
        <h2 class="text-5xl font-bold">T-NGON</h2>
        <p class="text-lg">Nh·∫•n n√∫t b√™n d∆∞·ªõi ƒë·ªÉ b·∫Øt ƒë·∫ßu ƒë·∫∑t m√≥n</p>
        <div class="button-container">
          <button class="start-button" onclick="startOrder()">üçΩÔ∏è B·∫ÆT ƒê·∫¶U</button>
        </div>
        <p id="table-info" class="text-sm text-gray-500 mt-4"></p>
      </div>
    </div>

    <!-- M√†n h√¨nh g·ªçi m√≥n (iframe) -->
    <div class="screen" id="iframe-screen">
      <!-- N√∫t quay l·∫°i th·ªß c√¥ng. K√≠ch th∆∞·ªõc nh·ªè, trong su·ªët, ƒë·∫∑t ·ªü g√≥c d∆∞·ªõi c√πng b√™n tr√°i -->
      <button class="return-button" onclick="clearPage()"></button>
      <!-- iframe s·∫Ω ƒë∆∞·ª£c t·∫°o v√† ch√®n v√†o ƒë√¢y -->
    </div>
  </div>

  <script>
    const LINKS_JSON_URL = "https://raw.githubusercontent.com/tngon462/QR/refs/heads/main/links.json";

    let selectedBan = null;

    function showScreen(screenId) {
      document.querySelectorAll('.screen').forEach(screen => {
        screen.style.display = 'none';
      });
      document.getElementById(screenId).style.display = 'flex';
    }

    function selectTable(banNumber) {
      selectedBan = banNumber;
      document.getElementById('table-info').textContent = `B·∫°n ƒëang ·ªü B√†n ${selectedBan}`;
      showScreen('start-screen');
    }

    function startOrder() {
      if (!selectedBan) {
        showError('Kh√¥ng t√¨m th·∫•y th√¥ng tin b√†n. Vui l√≤ng ch·ªçn l·∫°i.');
        return;
      }

      const startScreen = document.getElementById('start-screen');
      startScreen.style.display = 'none';
      
      const loadingMessage = document.createElement('div');
      loadingMessage.className = 'loading-indicator';
      loadingMessage.textContent = 'ƒêang t·∫£i trang g·ªçi m√≥n...';
      document.getElementById('main-container').appendChild(loadingMessage);

      fetch(LINKS_JSON_URL)
        .then(r => {
          if (!r.ok) throw new Error('Kh√¥ng th·ªÉ t·∫£i links.json');
          return r.json();
        })
        .then(data => {
          const url = data[selectedBan];
          if (url) {
            loadingMessage.remove();
            createIframe(url);
          } else {
            loadingMessage.remove();
            showError('Kh√¥ng t√¨m th·∫•y link cho b√†n ' + selectedBan);
            showScreen('start-screen');
          }
        })
        .catch(err => {
          loadingMessage.remove();
          showError('L·ªói t·∫£i file links.json: ' + err.message);
          showScreen('start-screen');
        });
    }

    function createIframe(url) {
      const iframeScreen = document.getElementById('iframe-screen');
      const returnButton = '<button class="return-button" onclick="clearPage()"></button>';
      iframeScreen.innerHTML = returnButton;
      const iframe = document.createElement('iframe');
      iframe.id = 'pos-iframe';
      iframe.className = 'iframe-container';
      iframe.src = url;
      iframeScreen.appendChild(iframe);
      showScreen('iframe-screen');
    }

    function clearPage() {
      const iframeScreen = document.getElementById('iframe-screen');
      if (iframeScreen) {
        iframeScreen.innerHTML = '';
      }
      showScreen('start-screen');
    }

    function showError(message) {
      const existingError = document.querySelector('.error-message');
      if (existingError) existingError.remove();
      
      const errorMessage = document.createElement('div');
      errorMessage.className = 'error-message';
      errorMessage.textContent = message;
      document.getElementById('main-container').appendChild(errorMessage);
      setTimeout(() => errorMessage.remove(), 5000);
    }
  </script>
</body>
</html>
